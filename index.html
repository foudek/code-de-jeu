<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Dernière Mise</title>
<style>
html,body{
  margin:0;
  background:black;
  overflow:hidden;
  color:white;
  font-family:monospace;
}
canvas{display:block;}
#ui{
  position:fixed;
  bottom:30px;
  width:100%;
  text-align:center;
}
</style>
</head>
<body>

<canvas id="c"></canvas>

<!-- VISAGE MAFIEUX SVG (ULTRA IMPORTANT) -->
<svg id="mafieux" viewBox="0 0 400 600" style="display:none">
  <path d="M200 40 C120 40 80 120 90 200 C100 300 140 360 200 380 C260 360 300 300 310 200 C320 120 280 40 200 40"
        fill="none" stroke="white" stroke-width="3"/>

  <!-- yeux -->
  <path d="M130 190 Q160 180 190 190" fill="none" stroke="white" stroke-width="2"/>
  <path d="M210 190 Q240 180 270 190" fill="none" stroke="white" stroke-width="2"/>
  <circle cx="160" cy="195" r="4" fill="white"/>
  <circle cx="240" cy="195" r="4" fill="white"/>

  <!-- nez -->
  <path d="M200 200 C190 240 185 260 200 270 C215 260 210 240 200 200"
        fill="none" stroke="white" stroke-width="2"/>

  <!-- bouche -->
  <path d="M160 300 Q200 315 240 300" fill="none" stroke="white" stroke-width="2"/>

  <!-- barbe -->
  <path d="M120 280 C130 350 160 390 200 400 C240 390 270 350 280 280"
        fill="none" stroke="white" stroke-width="2"/>

  <!-- cicatrice -->
  <path d="M250 140 L290 180" stroke="white" stroke-width="2"/>
</svg>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");

function resize(){
  canvas.width = innerWidth;
  canvas.height = innerHeight;
}
addEventListener("resize",resize);
resize();

/* ================= CAMÉRA CINÉ ================= */

let cam = { x:0, y:0, z:1, tx:0, ty:0, tz:1 };

function updateCam(){
  cam.x += (cam.tx - cam.x)*0.05;
  cam.y += (cam.ty - cam.y)*0.05;
  cam.z += (cam.tz - cam.z)*0.05;
}

function applyCam(){
  ctx.translate(canvas.width/2,canvas.height/2);
  ctx.scale(cam.z,cam.z);
  ctx.translate(-canvas.width/2+cam.x,-canvas.height/2+cam.y);
}

/* ================= SCÉNARIO 50+ PLANS ================= */

const script = [];
for(let i=0;i<55;i++){
  script.push({
    text: [
      "Le silence pèse.",
      "Chaque regard est un calcul.",
      "Les cartes n'ont pas de morale.",
      "On gagne toujours quelque chose.",
      "Même quand on perd.",
      "Personne ne sort indemne."
    ][i%6],
    zoom: 1 + i*0.01,
    x: Math.sin(i)*30,
    y: Math.cos(i)*20
  });
}

let scene = 0;

/* ================= DRAW ================= */

function drawFace(){
  const svg = document.getElementById("mafieux");
  const img = new Image();
  const xml = new XMLSerializer().serializeToString(svg);
  img.src = "data:image/svg+xml;base64," + btoa(xml);
  ctx.drawImage(img,canvas.width/2-200,canvas.height/2-300,400,600);
}

function draw(){
  ctx.fillStyle="black";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  updateCam();
  ctx.save();
  applyCam();

  drawFace();

  ctx.restore();

  ctx.fillStyle="white";
  ctx.font="18px monospace";
  ctx.fillText(script[scene].text,40,60);
}

/* ================= INPUT ================= */

canvas.addEventListener("click",()=>{
  scene++;
  if(scene>=script.length) scene=script.length-1;
  cam.tz = script[scene].zoom;
  cam.tx = script[scene].x;
  cam.ty = script[scene].y;
});

/* ================= LOOP ================= */

function loop(){
  draw();
  requestAnimationFrame(loop);
}
loop();
</script>

</body>
</html>
